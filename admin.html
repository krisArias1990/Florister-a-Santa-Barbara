<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Administrativo - Florister√≠a Santa B√°rbara</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ESTILOS DEL PANEL ADMIN - IGUAL QUE TE ENVI√â ANTES */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .admin-container { max-width: 1400px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); overflow: hidden; }
        .admin-header { background: linear-gradient(135deg, #d1477a 0%, #a83264 100%); color: white; padding: 25px 40px; display: flex; justify-content: space-between; align-items: center; border-bottom: 5px solid rgba(255,255,255,0.2); }
        .admin-header h1 { font-size: 2.2rem; display: flex; align-items: center; gap: 15px; }
        .admin-header h1 i { color: #ffeb3b; }
        .admin-actions { display: flex; gap: 15px; }
        .btn { padding: 12px 25px; border: none; border-radius: 10px; cursor: pointer; font-weight: 600; font-size: 16px; transition: all 0.3s; display: flex; align-items: center; gap: 10px; }
        .btn-primary { background: #25D366; color: white; }
        .btn-primary:hover { background: #1da851; transform: translateY(-2px); box-shadow: 0 5px 15px rgba(37, 211, 102, 0.4); }
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #5a6268; transform: translateY(-2px); }
        .btn-danger { background: #dc3545; color: white; }
        .btn-danger:hover { background: #c82333; transform: translateY(-2px); }
        .btn-logout { background: #333; color: white; }
        .btn-logout:hover { background: #222; transform: translateY(-2px); }
        .admin-tabs { display: flex; background: #f8f9fa; border-bottom: 2px solid #dee2e6; padding: 0 40px; }
        .admin-tab { padding: 18px 30px; background: none; border: none; border-bottom: 3px solid transparent; font-size: 1.1rem; font-weight: 600; color: #666; cursor: pointer; transition: all 0.3s; position: relative; }
        .admin-tab:hover { color: #d1477a; background: rgba(209, 71, 122, 0.05); }
        .admin-tab.active { color: #d1477a; border-bottom: 3px solid #d1477a; background: rgba(209, 71, 122, 0.1); }
        .admin-tab i { margin-right: 10px; font-size: 1.2rem; }
        .admin-content { padding: 30px 40px; min-height: 600px; }
        .tab-content { display: none; }
        .tab-content.active { display: block; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .form-section { background: #f8f9fa; padding: 30px; border-radius: 15px; margin-bottom: 30px; border: 1px solid #e9ecef; }
        .form-section h3 { color: #d1477a; margin-bottom: 25px; font-size: 1.5rem; display: flex; align-items: center; gap: 10px; }
        .form-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; margin-bottom: 25px; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #495057; font-size: 1rem; }
        .form-control { width: 100%; padding: 14px; border: 2px solid #ced4da; border-radius: 8px; font-size: 16px; transition: all 0.3s; background: white; }
        .form-control:focus { border-color: #d1477a; box-shadow: 0 0 0 0.2rem rgba(209, 71, 122, 0.25); outline: none; }
        .form-textarea { min-height: 120px; resize: vertical; }
        .form-actions { display: flex; gap: 15px; margin-top: 25px; padding-top: 25px; border-top: 1px solid #dee2e6; }
        .items-container { background: white; border-radius: 15px; border: 1px solid #e9ecef; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .items-header { display: grid; grid-template-columns: 2fr 1fr 2fr 1fr auto; gap: 15px; padding: 20px; background: #f8f9fa; font-weight: 600; color: #495057; border-bottom: 2px solid #dee2e6; }
        .item-row { display: grid; grid-template-columns: 2fr 1fr 2fr 1fr auto; gap: 15px; padding: 20px; border-bottom: 1px solid #e9ecef; align-items: center; transition: background 0.3s; }
        .item-row:hover { background: #f8f9fa; }
        .item-image { width: 60px; height: 60px; object-fit: cover; border-radius: 8px; border: 2px solid #dee2e6; }
        .item-name { font-weight: 600; color: #212529; }
        .item-price { color: #d1477a; font-weight: 700; font-size: 1.1rem; }
        .item-category { background: #e9ecef; padding: 5px 12px; border-radius: 20px; font-size: 0.9rem; display: inline-block; }
        .item-actions { display: flex; gap: 10px; }
        .btn-edit { background: #ffc107; color: #212529; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer; }
        .btn-delete { background: #dc3545; color: white; border: none; padding: 8px 12px; border-radius: 6px; cursor: pointer; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 25px; margin-bottom: 40px; }
        .stat-card { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.08); border-top: 5px solid #d1477a; }
        .stat-value { font-size: 2.5rem; font-weight: 800; color: #d1477a; line-height: 1; }
        .empty-state { text-align: center; padding: 60px 20px; color: #6c757d; }
        .notification { position: fixed; top: 20px; right: 20px; background: #d1477a; color: white; padding: 15px 25px; border-radius: 10px; z-index: 2000; box-shadow: 0 5px 20px rgba(209, 71, 122, 0.3); animation: slideInRight 0.3s ease; display: flex; align-items: center; gap: 12px; max-width: 400px; }
        @keyframes slideInRight { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @media (max-width: 768px) { .admin-header { flex-direction: column; gap: 20px; } .form-row { grid-template-columns: 1fr; } .items-header, .item-row { grid-template-columns: 1fr auto; } }
    </style>
</head>
<body>
    <div class="admin-container">
        <div class="admin-header">
            <h1><i class="fas fa-spa"></i> Panel Administrativo</h1>
            <div class="admin-actions">
                <button class="btn btn-primary" onclick="exportBackup()"><i class="fas fa-download"></i> Exportar</button>
                <button class="btn btn-secondary" onclick="importBackup()"><i class="fas fa-upload"></i> Importar</button>
                <button class="btn btn-logout" onclick="window.location.href='index.html'"><i class="fas fa-home"></i> Volver al Sitio</button>
            </div>
        </div>
        
        <div class="admin-tabs">
            <button class="admin-tab active" onclick="showTab('dashboard')"><i class="fas fa-tachometer-alt"></i> Dashboard</button>
            <button class="admin-tab" onclick="showTab('products')"><i class="fas fa-shopping-bag"></i> Productos</button>
            <button class="admin-tab" onclick="showTab('categories')"><i class="fas fa-tags"></i> Categor√≠as</button>
            <button class="admin-tab" onclick="showTab('orders')"><i class="fas fa-clipboard-list"></i> Pedidos</button>
            <button class="admin-tab" onclick="showTab('settings')"><i class="fas fa-cog"></i> Configuraci√≥n</button>
        </div>
        
        <div class="admin-content">
            <!-- DASHBOARD -->
            <div id="dashboard" class="tab-content active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <h4>Total de Productos</h4>
                        <div class="stat-value" id="totalProducts">0</div>
                    </div>
                    <div class="stat-card">
                        <h4>Pedidos Totales</h4>
                        <div class="stat-value" id="totalOrders">0</div>
                    </div>
                    <div class="stat-card">
                        <h4>Ventas Totales</h4>
                        <div class="stat-value" id="totalSales">‚Ç° 0</div>
                    </div>
                    <div class="stat-card">
                        <h4>Categor√≠as</h4>
                        <div class="stat-value" id="totalCategories">0</div>
                    </div>
                </div>
                
                <div class="form-section">
                    <h3><i class="fas fa-question-circle"></i> ¬øC√≥mo usar el panel?</h3>
                    <p><strong>1. PRODUCTOS:</strong> Agrega todos tus arreglos florales con fotos y precios.</p>
                    <p><strong>2. CATEGOR√çAS:</strong> Organiza por tipo (Rosas, Bodas, Cumplea√±os, etc.).</p>
                    <p><strong>3. PEDIDOS:</strong> Revisa los pedidos recibidos por WhatsApp.</p>
                    <p><strong>4. CONFIGURACI√ìN:</strong> Cambia n√∫mero de WhatsApp, horarios, etc.</p>
                    <p><strong>üí° Tip:</strong> Siempre haz Backup antes de hacer cambios importantes.</p>
                </div>
            </div>
            
            <!-- PRODUCTOS -->
            <div id="products" class="tab-content">
                <div class="form-section">
                    <h3><i class="fas fa-plus-circle"></i> Agregar Producto</h3>
                    <form id="productForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Nombre del Producto</label>
                                <input type="text" id="prodName" class="form-control" placeholder="Ej: Ramo de Rosas Rojas" required>
                            </div>
                            <div class="form-group">
                                <label>Categor√≠a</label>
                                <select id="prodCategory" class="form-control" required>
                                    <option value="">Seleccionar...</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Precio Normal (‚Ç°)</label>
                                <input type="number" id="prodPriceNormal" class="form-control" min="0" required>
                            </div>
                            <div class="form-group">
                                <label>Precio Temporada Alta (‚Ç°)</label>
                                <input type="number" id="prodPriceHigh" class="form-control" min="0" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Descripci√≥n</label>
                            <textarea id="prodDescription" class="form-control form-textarea" placeholder="Describe el arreglo floral..." required></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>URL Imagen Peque√±a</label>
                                <input type="url" id="prodImage" class="form-control" placeholder="https://..." required>
                            </div>
                            <div class="form-group">
                                <label>URL Imagen Grande</label>
                                <input type="url" id="prodImageFull" class="form-control" placeholder="https://..." required>
                            </div>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> Guardar Producto</button>
                        </div>
                    </form>
                </div>
                
                <div class="form-section">
                    <h3><i class="fas fa-boxes"></i> Lista de Productos</h3>
                    <div class="items-container" id="productsListContainer">
                        <!-- Los productos se cargar√°n aqu√≠ -->
                    </div>
                </div>
            </div>
            
            <!-- CATEGOR√çAS -->
            <div id="categories" class="tab-content">
                <div class="form-section">
                    <h3><i class="fas fa-plus-circle"></i> Agregar Categor√≠a</h3>
                    <form id="categoryForm">
                        <div class="form-group">
                            <label>Nombre de Categor√≠a</label>
                            <input type="text" id="catName" class="form-control" placeholder="Ej: Rosas, Bodas, Cumplea√±os" required>
                        </div>
                        <div class="form-group">
                            <label>Descripci√≥n (opcional)</label>
                            <textarea id="catDescription" class="form-control form-textarea"></textarea>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> Guardar Categor√≠a</button>
                        </div>
                    </form>
                </div>
                
                <div class="form-section">
                    <h3><i class="fas fa-tags"></i> Categor√≠as Existentes</h3>
                    <div class="items-container" id="categoriesListContainer">
                        <!-- Las categor√≠as se cargar√°n aqu√≠ -->
                    </div>
                </div>
            </div>
            
            <!-- PEDIDOS -->
            <div id="orders" class="tab-content">
                <div class="form-section">
                    <h3><i class="fas fa-shopping-cart"></i> Pedidos Recibidos</h3>
                    <div class="items-container">
                        <div class="items-header">
                            <div>Fecha</div>
                            <div>Cliente</div>
                            <div>Productos</div>
                            <div>Total</div>
                            <div>Estado</div>
                        </div>
                        <div id="ordersListContainer">
                            <!-- Los pedidos se cargar√°n aqu√≠ -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- CONFIGURACI√ìN -->
            <div id="settings" class="tab-content">
                <div class="form-section">
                    <h3><i class="fas fa-cog"></i> Configuraci√≥n de la Tienda</h3>
                    <form id="settingsForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>N√∫mero de WhatsApp</label>
                                <input type="text" id="whatsappNumber" class="form-control" value="86053613" required>
                            </div>
                            <div class="form-group">
                                <label>Nombre de la Tienda</label>
                                <input type="text" id="storeName" class="form-control" value="Florister√≠a Santa B√°rbara" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Direcci√≥n</label>
                            <textarea id="storeAddress" class="form-control" rows="2">Santa B√°rbara, Heredia, Costa Rica</textarea>
                        </div>
                        <div class="form-group">
                            <label>Horario de Atenci√≥n</label>
                            <input type="text" id="businessHours" class="form-control" value="Lunes a S√°bado 8am-6pm">
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary"><i class="fas fa-save"></i> Guardar Configuraci√≥n</button>
                        </div>
                    </form>
                </div>
                
                <div class="form-section">
                    <h3><i class="fas fa-calendar-alt"></i> Temporadas Altas</h3>
                    <p>Los precios aumentan autom√°ticamente en estas fechas:</p>
                    <div id="seasonsList">
                        <div class="item-row">
                            <div><strong>San Valent√≠n</strong><br>1-15 Febrero</div>
                            <div class="item-actions">
                                <button class="btn-edit"><i class="fas fa-edit"></i></button>
                            </div>
                        </div>
                        <div class="item-row">
                            <div><strong>D√≠a de la Madre</strong><br>1-15 Mayo</div>
                            <div class="item-actions">
                                <button class="btn-edit"><i class="fas fa-edit"></i></button>
                            </div>
                        </div>
                        <div class="item-row">
                            <div><strong>Navidad</strong><br>15 Nov - 31 Dic</div>
                            <div class="item-actions">
                                <button class="btn-edit"><i class="fas fa-edit"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // CONFIGURACI√ìN
        const STORAGE_KEY = 'floristeria_santa_barbara_data';
        
        // DATOS INICIALES
        let appData = {
            products: [],
            categories: [
                { id: 'cat1', nombre: 'Rosas', descripcion: 'Arreglos con rosas' },
                { id: 'cat2', nombre: 'Bodas', descripcion: 'Arreglos para bodas' },
                { id: 'cat3', nombre: 'Cumplea√±os', descripcion: 'Arreglos para cumplea√±os' }
            ],
            orders: [],
            settings: {
                whatsappNumber: '86053613',
                storeName: 'Florister√≠a Santa B√°rbara',
                address: 'Santa B√°rbara, Heredia, Costa Rica',
                businessHours: 'Lunes a S√°bado 8am-6pm'
            }
        };
        
        // CARGAR DATOS AL INICIO
        function loadData() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                try {
                    appData = JSON.parse(saved);
                } catch (e) {
                    console.log('Usando datos por defecto');
                }
            }
            updateUI();
        }
        
        // GUARDAR DATOS
        function saveData() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(appData));
            updateUI();
        }
        
        // ACTUALIZAR INTERFAZ
        function updateUI() {
            // Actualizar estad√≠sticas
            document.getElementById('totalProducts').textContent = appData.products.length;
            document.getElementById('totalOrders').textContent = appData.orders.length;
            document.getElementById('totalCategories').textContent = appData.categories.length;
            
            // Calcular ventas totales
            const totalSales = appData.orders.reduce((sum, order) => sum + (order.total || 0), 0);
            document.getElementById('totalSales').textContent = `‚Ç° ${totalSales.toLocaleString()}`;
            
            // Actualizar lista de productos
            updateProductsList();
            
            // Actualizar lista de categor√≠as
            updateCategoriesList();
            
            // Actualizar select de categor√≠as
            updateCategorySelect();
            
            // Actualizar pedidos
            updateOrdersList();
        }
        
        // FUNCIONES DE PESTA√ëAS
        function showTab(tabId) {
            // Ocultar todas las pesta√±as
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Desactivar todos los botones de pesta√±a
            document.querySelectorAll('.admin-tab').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Activar pesta√±a seleccionada
            document.getElementById(tabId).classList.add('active');
            
            // Activar bot√≥n correspondiente
            event.target.classList.add('active');
        }
        
        // PRODUCTOS
        function updateProductsList() {
            const container = document.getElementById('productsListContainer');
            
            if (appData.products.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-box-open"></i>
                        <h3>No hay productos</h3>
                        <p>Agrega tu primer producto usando el formulario.</p>
                    </div>
                `;
                return;
            }
            
            let html = '<div class="items-header"><div>Producto</div><div>Precio</div><div>Categor√≠a</div><div>Acciones</div></div>';
            
            appData.products.forEach(product => {
                html += `
                    <div class="item-row">
                        <div class="item-name">${product.nombre}</div>
                        <div class="item-price">‚Ç° ${product.precioBaja.toLocaleString()}</div>
                        <div><span class="item-category">${product.categoria}</span></div>
                        <div class="item-actions">
                            <button class="btn-edit" onclick="editProduct('${product.id}')"><i class="fas fa-edit"></i></button>
                            <button class="btn-delete" onclick="deleteProduct('${product.id}')"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        function updateCategorySelect() {
            const select = document.getElementById('prodCategory');
            select.innerHTML = '<option value="">Seleccionar...</option>' +
                appData.categories.map(cat => 
                    `<option value="${cat.nombre}">${cat.nombre}</option>`
                ).join('');
        }
        
        document.getElementById('productForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const newProduct = {
                id: 'prod_' + Date.now(),
                nombre: document.getElementById('prodName').value,
                categoria: document.getElementById('prodCategory').value,
                precioBaja: parseInt(document.getElementById('prodPriceNormal').value),
                precioAlta: parseInt(document.getElementById('prodPriceHigh').value),
                descripcion: document.getElementById('prodDescription').value,
                foto: document.getElementById('prodImage').value,
                foto_full: document.getElementById('prodImageFull').value,
                createdAt: new Date().toISOString()
            };
            
            appData.products.push(newProduct);
            saveData();
            
            // Limpiar formulario
            this.reset();
            
            // Mostrar notificaci√≥n
            showNotification('‚úÖ Producto agregado correctamente');
            
            // Cambiar a la pesta√±a de productos
            showTab('products');
        });
        
        function editProduct(id) {
            const product = appData.products.find(p => p.id === id);
            if (!product) return;
            
            // Llenar formulario con datos del producto
            document.getElementById('prodName').value = product.nombre;
            document.getElementById('prodCategory').value = product.categoria;
            document.getElementById('prodPriceNormal').value = product.precioBaja;
            document.getElementById('prodPriceHigh').value = product.precioAlta;
            document.getElementById('prodDescription').value = product.descripcion;
            document.getElementById('prodImage').value = product.foto;
            document.getElementById('prodImageFull').value = product.foto_full;
            
            // Eliminar el producto antiguo
            deleteProduct(id, false);
            
            // Mostrar notificaci√≥n
            showNotification('üìù Edita los valores y guarda los cambios');
            
            // Cambiar a la pesta√±a de agregar producto
            showTab('products');
            document.getElementById('products').scrollIntoView();
        }
        
        function deleteProduct(id, showAlert = true) {
            appData.products = appData.products.filter(p => p.id !== id);
            saveData();
            
            if (showAlert) {
                showNotification('üóëÔ∏è Producto eliminado');
            }
        }
        
        // CATEGOR√çAS
        function updateCategoriesList() {
            const container = document.getElementById('categoriesListContainer');
            
            if (appData.categories.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-tags"></i>
                        <h3>No hay categor√≠as</h3>
                        <p>Agrega tu primera categor√≠a.</p>
                    </div>
                `;
                return;
            }
            
            let html = '<div class="items-header"><div>Categor√≠a</div><div>Descripci√≥n</div><div>Productos</div><div>Acciones</div></div>';
            
            appData.categories.forEach(category => {
                const productCount = appData.products.filter(p => p.categoria === category.nombre).length;
                
                html += `
                    <div class="item-row">
                        <div class="item-name">${category.nombre}</div>
                        <div>${category.descripcion || 'Sin descripci√≥n'}</div>
                        <div>${productCount} productos</div>
                        <div class="item-actions">
                            <button class="btn-edit" onclick="editCategory('${category.id}')"><i class="fas fa-edit"></i></button>
                            <button class="btn-delete" onclick="deleteCategory('${category.id}')"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        document.getElementById('categoryForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const newCategory = {
                id: 'cat_' + Date.now(),
                nombre: document.getElementById('catName').value,
                descripcion: document.getElementById('catDescription').value
            };
            
            appData.categories.push(newCategory);
            saveData();
            
            // Limpiar formulario
            this.reset();
            
            showNotification('‚úÖ Categor√≠a agregada');
        });
        
        function editCategory(id) {
            const category = appData.categories.find(c => c.id === id);
            if (!category) return;
            
            document.getElementById('catName').value = category.nombre;
            document.getElementById('catDescription').value = category.descripcion || '';
            
            // Eliminar la categor√≠a antigua
            deleteCategory(id, false);
            
            showNotification('üìù Edita los valores y guarda los cambios');
        }
        
        function deleteCategory(id, showAlert = true) {
            const category = appData.categories.find(c => c.id === id);
            
            // Verificar si hay productos usando esta categor√≠a
            const productsUsingCategory = appData.products.filter(p => p.categoria === category.nombre);
            
            if (productsUsingCategory.length > 0 && showAlert) {
                showNotification(`‚ùå No se puede eliminar. Hay ${productsUsingCategory.length} productos usando esta categor√≠a.`);
                return;
            }
            
            appData.categories = appData.categories.filter(c => c.id !== id);
            saveData();
            
            if (showAlert) {
                showNotification('üóëÔ∏è Categor√≠a eliminada');
            }
        }
        
        // PEDIDOS
        function updateOrdersList() {
            const container = document.getElementById('ordersListContainer');
            
            if (appData.orders.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-clipboard-list"></i>
                        <h3>No hay pedidos</h3>
                        <p>Los pedidos recibidos por WhatsApp aparecer√°n aqu√≠.</p>
                    </div>
                `;
                return;
            }
            
            // Mostrar √∫ltimos 10 pedidos
            const recentOrders = appData.orders.slice(-10).reverse();
            
            recentOrders.forEach(order => {
                const date = new Date(order.date || Date.now());
                const formattedDate = date.toLocaleDateString('es-CR');
                
                container.innerHTML += `
                    <div class="item-row">
                        <div>${formattedDate}</div>
                        <div>${order.customer?.name || 'Cliente'}</div>
                        <div>${order.items?.length || 0} productos</div>
                        <div class="item-price">‚Ç° ${(order.total || 0).toLocaleString()}</div>
                        <div><span class="item-category">${order.status || 'Pendiente'}</span></div>
                    </div>
                `;
            });
        }
        
        // CONFIGURACI√ìN
        document.getElementById('settingsForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            appData.settings = {
                whatsappNumber: document.getElementById('whatsappNumber').value,
                storeName: document.getElementById('storeName').value,
                address: document.getElementById('storeAddress').value,
                businessHours: document.getElementById('businessHours').value
            };
            
            saveData();
            showNotification('‚úÖ Configuraci√≥n guardada');
        });
        
        // BACKUP
        function exportBackup() {
            const dataStr = JSON.stringify(appData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `backup_floristeria_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            showNotification('üíæ Backup exportado correctamente');
        }
        
        function importBackup() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(e) {
                const file = e.target.files[0];
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const importedData = JSON.parse(e.target.result);
                        appData = importedData;
                        saveData();
                        showNotification('‚úÖ Backup importado correctamente');
                    } catch (error) {
                        showNotification('‚ùå Error: Archivo inv√°lido');
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }
        
        // NOTIFICACIONES
        function showNotification(message) {
            // Remover notificaciones existentes
            const existing = document.querySelector('.notification');
            if (existing) existing.remove();
            
            // Crear nueva notificaci√≥n
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.innerHTML = `<i class="fas fa-info-circle"></i> ${message}`;
            document.body.appendChild(notification);
            
            // Auto-eliminar despu√©s de 3 segundos
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.style.animation = 'slideInRight 0.3s ease reverse';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            document.body.removeChild(notification);
                        }
                    }, 300);
                }
            }, 3000);
        }
        
        // INICIALIZAR
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            
            // Cargar configuraci√≥n en el formulario
            document.getElementById('whatsappNumber').value = appData.settings.whatsappNumber;
            document.getElementById('storeName').value = appData.settings.storeName;
            document.getElementById('storeAddress').value = appData.settings.address;
            document.getElementById('businessHours').value = appData.settings.businessHours;
        });
        
        // Hacer funciones globales
        window.showTab = showTab;
        window.exportBackup = exportBackup;
        window.importBackup = importBackup;
        window.editProduct = editProduct;
        window.deleteProduct = deleteProduct;
        window.editCategory = editCategory;
        window.deleteCategory = deleteCategory;
    </script>
</body>
</html>
